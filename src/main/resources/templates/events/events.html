<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{layout/header :: head}"></head>

<!-- âœ… ìº˜ë¦°ë” í˜ì´ì§€ì™€ ë™ì¼í•œ ìŠ¤íƒ€ì¼ ì ìš© -->
<style>
    .custom-card {
        max-width: 1000px;
        margin: 40px auto;
        padding: 20px;
        background-color: white;
        border-radius: 20px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }
    .custom-title {
        font-size: 2.5rem;
        font-weight: 700;
        color: #0d6efd;
    }
    .table th, .table td {
        text-align: center;
        vertical-align: middle;
    }
    .btn-custom {
        width: 180px;
        font-weight: 600;
        background-color: white;
        color: #0d6efd;
        border: 2px solid #0d6efd;
        transition: all 0.3s ease;
    }
    .btn-custom:hover {
        background-color: #0d6efd;
        color: white;
        border-color: #0d6efd;
    }
    .btn-danger {
        width: 100px;
        transition: all 0.3s ease;
    }
    .btn-danger:hover {
        background-color: #dc3545;
        border-color: #bb2d3b;
    }
</style>

<body class="bg-light">
<div class="container py-5">
    <div class="text-center mb-4">
        <h1 class="custom-title">ğŸ“… To do Calendar</h1>
        <p class="lead">ë“±ë¡ëœ ëª¨ë“  ì¼ì •ì„ í•œëˆˆì— í™•ì¸í•˜ê³  ê´€ë¦¬í•˜ì„¸ìš”.</p>
        <button class="btn btn-custom mt-3" onclick="location.href='/'">ğŸ  í™ˆìœ¼ë¡œ</button>
    </div>

    <div class="custom-card">
        <table class="table table-hover mt-4" id="eventTable">
            <thead class="table-dark">
            <tr>
                <th scope="col">ID</th>
                <th scope="col">ì œëª©</th>
                <th scope="col">ì„¤ëª…</th>
                <th scope="col">ì‹œì‘ ë‚ ì§œ</th>
                <th scope="col">ì¢…ë£Œ ë‚ ì§œ</th>
                <th scope="col">íšŒì› ì´ë¦„</th>
                <th scope="col">ì‚­ì œ</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="event : ${events}" th:attr="data-id=${event.id}">
                <td th:text="${event.id}"></td>
                <td th:text="${event.title}"></td>
                <td th:text="${event.description}"></td>
                <td th:text="${event.start}"></td>
                <td th:text="${event.end}"></td>
                <td th:text="${event.name}"></td>
                <td>
                    <button type="button" class="btn btn-danger delete-btn">ì‚­ì œ</button>
                </td>
            </tr>
            </tbody>
        </table>
    </div>
</div>

<!-- âœ… JavaScript: ì‚­ì œ ë¹„ë™ê¸° ì²˜ë¦¬ -->
<script>
    document.addEventListener('DOMContentLoaded', function() {
        const table = document.getElementById('eventTable');
        table.addEventListener('click', function(e) {
            if (e.target.classList.contains('delete-btn')) {
                const row = e.target.closest('tr');
                const eventId = row.getAttribute('data-id');

                if (confirm('ì •ë§ë¡œ í•´ë‹¹ ì¼ì •ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                    fetch(`/api/events/${eventId}`, {
                        method: 'DELETE'
                    })
                    .then(response => {
                        if (!response.ok) throw new Error('ì‚­ì œ ì‹¤íŒ¨');
                        row.remove();
                        alert('ì¼ì •ì´ ì„±ê³µì ìœ¼ë¡œ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
                    })
                    .catch(error => {
                        console.error('ì‚­ì œ ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', error);
                        alert('ì‚­ì œ ì¤‘ ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                    });
                }
            }
        });
    });
</script>
</body>
</html>